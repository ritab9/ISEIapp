<!-- selfstudy_personnel_include.html -->
<div class="page page-break">
    <h5 class="mt-4 mb-4">D. Personnel Data</h5>

    {% if admin_academic_dean or vocational_instructors or non_instructional %}

        <!-- 1. Administrative / Academic Instructors / Deans -->
        <div class="keep-together">
            <h6 class="mt-3 mb-2">1. Administrative, Academic Instructors, Deans</h6>
            <table class="table table-sm table-striped table-bordered">
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Status</th>
                    <th>Assignment/Responsibility</th>
                    <th>Highest Degree</th>
                    <th>Certification</th>
                    <th>Renewal Date</th>
                    <th>Years Experience</th>
                    <th>Years at this School</th>
                </tr>
            </thead>
            <tbody>
                {% for p in admin_academic_dean %}
                    <tr>
                        <td>{{ p.first_name }} {{ p.last_name }}</td>
                        <td>{{ p.status }}</td>
                        <td>
                            {% for position in p.position.all %}
                                {{ position.name }}<br>
                            {% empty %}
                                –
                            {% endfor %}
                        </td>
                        <td>{{ p.highest_degree|default:"–" }}</td>
                        <td>{{ p.certification|default:"–" }}</td>
                        <td>{{ p.cert_renewal_date|date:"Y-m-d"|default:"–" }}</td>
                        <td>{{ p.years_experience|default:"–" }}</td>
                        <td>{{ p.years_at_this_school|default:"–" }}</td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
        </div>
        <hr>

        <!-- 2. Vocational Instructors -->
        <div class="keep-together">
            <h6 class="mt-3 mb-2">2. Vocational Instructors</h6>
            <table class="table table-sm table-striped table-bordered">
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Status</th>
                    <th>Assignment/Responsibility</th>
                    <th>Highest Degree</th>
                    <th>Certification</th>
                    <th>Renewal Date</th>
                    <th>Years Experience</th>
                    <th>Years at this School</th>
                </tr>
            </thead>
            <tbody>
                {% for p in vocational_instructors %}
                    <tr>
                        <td>{{ p.first_name }} {{ p.last_name }}</td>
                        <td>{{ p.status }}</td>
                        <td>
                            {% for position in p.position.all %}
                                {{ position.name }}<br>
                            {% empty %}
                                –
                            {% endfor %}
                        </td>
                        <td>{{ p.highest_degree|default:"–" }}</td>
                        <td>{{ p.certification|default:"–" }}</td>
                        <td>{{ p.cert_renewal_date|date:"Y-m-d"|default:"–" }}</td>
                        <td>{{ p.years_experience|default:"–" }}</td>
                        <td>{{ p.years_at_this_school|default:"–" }}</td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
        </div>
        <hr>

        <!-- 3. Non-instructional Staff -->
        <div class="keep-together">
            <h6 class="mt-3 mb-2">3. Non-instructional Staff</h6>
            <table class="table table-sm table-striped table-bordered">
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Status</th>
                    <th>Assignment/Responsibility</th>
                    <th>Years Experience</th>
                    <th>Years at this School</th>
                </tr>
            </thead>
            <tbody>
                {% for p in non_instructional %}
                    <tr>
                        <td>{{ p.first_name }} {{ p.last_name }}</td>
                        <td>{{ p.status }}</td>
                        <td>
                            {% for position in p.position.all %}
                                {{ position.name }}<br>
                            {% empty %}
                                –
                            {% endfor %}
                        </td>
                        <td>{{ p.years_experience|default:"–" }}</td>
                        <td>{{ p.years_at_this_school|default:"–" }}</td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
        </div>
        <hr>

        <div class="keep-together">
            <h6>4. Additional Staff Data</h6>
            <h6 class="mt-3 mb-2">a. FTE Assignments</h6>

            {% if fte_context and fte_context.fte_list %}
                <table class="table table-sm table-striped table-bordered">
                    <thead class="blue-header2">
                        <tr>
                            <th>Assignment</th>
                            <th>FTE Men</th>
                            <th>FTE Women</th>
                            <th>Total</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for fte in fte_context.fte_list %}
                            <tr>
                                <td>{{ fte.assignment }}</td>
                                <td>{{ fte.men|default:"–" }}</td>
                                <td>{{ fte.women|default:"–" }}</td>
                                <td>{{ fte.total|default:"–" }}</td>
                            </tr>
                        {% endfor %}
                    </tbody>
                    <tfoot>
                        <tr>
                            <th>Total</th>
                            <th>{{ fte_context.total_men|default:"–" }}</th>
                            <th>{{ fte_context.total_women|default:"–" }}</th>
                            <th>{{ fte_context.grand_total|default:"–" }}</th>
                        </tr>
                    </tfoot>
                </table>
                    <h6>b. Ratio of Students to FTE Instructional Staff: {{ fte_context.fte_student_ratio }}</h6>

            {% else %}
                <p><em>No FTE data available.</em></p>
            {% endif %}
        </div>

        <!-- 4. Degree & Gender Summary -->
        <div class="keep-together">
            <h6 class="mt-3 mb-2">c. Summary of Academic Preparation</h6>
            <table class="table table-sm table-striped table-bordered">
            <thead>
                <tr>
                    <th>Degree</th>
                    <th>Men</th>
                    <th>Women</th>
                    <th>Totals</th>
                </tr>
            </thead>
            <tbody>
                {% for degree, counts in degree_gender_dict.items %}
                    <tr>
                        <td>{{ degree|default:"–" }}</td>
                        <td>{{ counts.M|default:"0" }}</td>
                        <td>{{ counts.F|default:"0" }}</td>
                        <td>{{ counts.M|add:counts.F }}</td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
        </div>
        <hr>

        <!-- 5. Staff Retention Data -->
        <div class="keep-together">
            <h6 class="mt-3 mb-2">d. Staff Retention Data</h6>
            <table class="table table-sm table-striped table-bordered">
                <thead>
                    <tr>
                        <th>School Year</th>
                        <th>Total Staff</th>
                        <th>Did Not Return</th>
                        <th>Retention Rate</th>
                    </tr>
                </thead>
                <tbody>
                    {% for row in retention_data %}
                        <tr>
                            <td>{{ row.year }}</td>
                            <td>{{ row.total|default:"–" }}</td>
                            <td>{{ row.not_returned|default:"–" }}</td>
                            <td>
                                {% if row.retention is not None %}
                                    {{ row.retention }}%
                                {% else %}
                                    –
                                {% endif %}
                            </td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>

            <!-- Status Legend -->
            <div class="legend mt-2">
                <strong>Status Legend:</strong>
                <span><strong>FT</strong> - Full Time</span> |
                <span><strong>PT</strong> - Part Time</span> |
                <span><strong>VO</strong> - Volunteer</span> |
                <span><strong>LO</strong> - Leave of Absence</span>
            </div>
        </div>


    {% else %}
        <p><em>No personnel data available.</em></p>
    {% endif %}

    <div class="keep-together">
        <h6 class="mt-3 mb-2">5. Professional Growth Activities</h6>
        <p>List any significant professional growth activities provided for your teachers that have improved instructional methods in the past two years.</p>

        {% if pga_list %}
            <table class="table table-sm table-striped table-bordered">
                <thead class="blue-header2">
                    <tr>
                        <th>#</th>
                        <th>Professional Growth Activity</th>
                        <th>Briefly Describe Improvements</th>
                    </tr>
                </thead>
                <tbody>
                    {% for item in pga_list %}
                        <tr>
                            <td>{{ forloop.counter }}</td>
                            <td>{{ item.activity }}</td>
                            <td>{{ item.improvement }}</td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        {% else %}
            <p><em>No professional growth activities recorded.</em></p>
        {% endif %}
    </div>

    <p class="back-to-toc">
        <a href="#toc">⬆ TOC</a>
    </p>
</div>
